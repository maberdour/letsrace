{
  "Name": "CTT-Events",
  "CreationDate": "2026-2-3",
  "Commands": [
    {
      "Command": "XRun",
      "Target": "cmd.exe",
      "Value": "/c del \"H:\\My Drive\\Clients\\LetsRace\\UIVision\\datasources\\ctt_event_data.csv\"",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "fast",
      "Value": "!replayspeed",
      "Description": ""
    },
    {
      "Command": "csvReadArray",
      "Target": "URLS-CTT.csv",
      "Value": "urlData",
      "Description": "Read all URLs from CSV"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${urlData}.length;",
      "Value": "urlCount",
      "Description": "Get number of URLs"
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "urlIndex",
      "Description": "Start at row 0 (first data row after header)"
    },
    {
      "Command": "while_v2",
      "Target": "${urlIndex} < ${urlCount}",
      "Value": "",
      "Description": "Loop through all URLs"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${urlData}[${urlIndex}][0];",
      "Value": "raceType",
      "Description": "Get race type from column A"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return String(${raceType}).replace(/^\\uFEFF/, '');",
      "Value": "raceType",
      "Description": "Strip BOM from race type"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${urlData}[${urlIndex}][1];",
      "Value": "currentUrl",
      "Description": "Get URL from column B"
    },
    {
      "Command": "echo",
      "Target": "Processing race type: ${raceType}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "open",
      "Target": "${currentUrl}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "Page-Down to end of page",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "bringBrowserToForeground",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "XClick // xpath=//span[@class=\"block archivo_e255c303-module__RfbGYW__className text-[12pt] md:text-[11pt] xl:text-[11pt] font-[900] leading-tight text-neutral-950 dark:text-neutral-300 md:pl-14\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "XType",
      "Target": "${KEY_END}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "1000",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "XType",
      "Target": "${KEY_END}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "1000",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "XType",
      "Target": "${KEY_END}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "1000",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "XType",
      "Target": "${KEY_END}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "1000",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "XType",
      "Target": "${KEY_END}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "1000",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "XType",
      "Target": "${KEY_END}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "1000",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "XType",
      "Target": "${KEY_END}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "1000",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "XType",
      "Target": "${KEY_END}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "1000",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "XType",
      "Target": "${KEY_END}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "1000",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "XType",
      "Target": "${KEY_END}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "1000",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeXpathCount",
      "Target": "xpath=(//span[contains(@class, 'block archivo_e255c303-module__RfbGYW__className text-[13pt] md:text-[14pt] xl:text-[15pt] font-[900] uppercase leading-tight text-neutral-950 dark:text-neutral-300')])",
      "Value": "filesCount",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Number of rows to extract = ${filesCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "1",
      "Value": "loopCount",
      "Description": ""
    },
    {
      "Command": "while_v2",
      "Target": "${loopCount} <= ${filesCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Loop number: ${loopCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=(//span[contains(@class, 'block archivo_e255c303-module__RfbGYW__className text-[13pt] md:text-[14pt] xl:text-[15pt] font-[900] uppercase leading-tight text-neutral-950 dark:text-neutral-300')])[${loopCount}]",
      "Value": "!csvLine",
      "Description": "Event Date"
    },
    {
      "Command": "storeText",
      "Target": "xpath=(//h4[contains(@class, 'block archivo_e255c303-module__RfbGYW__className text-[13pt] md:text-[14pt] xl:text-[15pt] font-[900] leading-tight text-neutral-950 dark:text-neutral-300')])[${loopCount}]",
      "Value": "!csvLine",
      "Description": "Event Title"
    },
    {
      "Command": "store",
      "Target": "${raceType}",
      "Value": "!csvLine",
      "Description": "Event Type"
    },
    {
      "Command": "storeText",
      "Target": "xpath=(//p[contains(@class,'block archivo_e255c303-module__RfbGYW__className text-[11pt] md:text-[11pt] xl:text-[11pt] font-[600] text-neutral-950 dark:text-neutral-300')])[${loopCount}]",
      "Value": "!csvLine",
      "Description": "Event Location"
    },
    {
      "Command": "storeAttribute",
      "Target": "xpath=(//div[contains(@class,\"grid\") and contains(@class,\"gap-4\")]//a[starts-with(@href,\"/events/\")])[${loopCount}]@href",
      "Value": "!csvLine",
      "Description": "URL"
    },
    {
      "Command": "csvSave",
      "Target": "ctt_event_data",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${loopCount}) + 1;",
      "Value": "loopCount",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${urlIndex}) + 1;",
      "Value": "urlIndex",
      "Description": "Move to next URL"
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "End URL loop"
    }
  ]
}